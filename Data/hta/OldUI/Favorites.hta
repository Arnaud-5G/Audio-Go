<!DOCTYPE html>
<html>

<head>
  <title>Favorites</title>
</head>

<body>
    <script language="VBScript">
        Sub Window_OnLoad
            Load
        End Sub

        Sub Load
            ' clear the html
            document.getElementById("Favs").innerHTML = ""

            ' add html for each favorite
            i = 0
            max = UBound(Split(Read(".\Data\dat\Favorites.dat", "*AllData"), vbCrLf))+i
            For Each fav in Split(Read(".\Data\dat\Favorites.dat", "*AllData"), vbCrLf)
                i = i + 1 
                favName = Split(fav, "\")(UBound(Split(fav, "\")))
                strHTML = document.getElementById("Favs").innerHTML
                document.getElementById("Favs").innerHTML = strHTML & "<button type=" & Chr(34) & "button" & Chr(34) & " id=" & Chr(34) & "Fav" & i & "UpButton" & Chr(34) & " style=" & Chr(34) & "height: 24px; width: 24px;" & Chr(34) & " name=" & Chr(34) & "Fav" & i & "UpButton" & Chr(34) & " onclick=" & Chr(34) & "vbscript: Up " & i & Chr(34) & " tabindex=" & Chr(34) & "-1" & Chr(34) & "></button><button type=" & Chr(34) & "button" & Chr(34) & " id=" & Chr(34) & "Fav" & i & "DownButton" & Chr(34) & " style=" & Chr(34) & "height: 24px; width: 24px;" & Chr(34) & " name=" & Chr(34) & "Fav" & i & "DownButton" & Chr(34) & " onclick=" & Chr(34) & "vbscript: Down " & i & Chr(34) & " tabindex=" & Chr(34) & "-1" & Chr(34) & "></button> Fav" & i & " | <span id=" & Chr(34) & "Fav" & i & "Span" & Chr(34) & ">" & favName & "</span><button type=" & Chr(34) & "button" & Chr(34) & " id=" & Chr(34) & "Fav1RemoveButton" & Chr(34) & " style=" & Chr(34) & "height: 24px; width: 24px;" & Chr(34) & " name=" & Chr(34) & "Fav1RemoveButton" & Chr(34) & " onclick=" & Chr(34) & "vbscript: Remove " & i & Chr(34) & " tabindex=" & Chr(34) & "-1" & Chr(34) & "></button><br>"
                If i = max Then
                    Exit For
                End If
            Next

            strHTML = document.getElementById("Favs").innerHTML
            document.getElementById("Favs").innerHTML = strHTML & "<button type=" & Chr(34) & "button" & Chr(34) & " style=" & Chr(34) & "height: 24px; width: 24px;" & Chr(34) & " onclick=" & Chr(34) & "vbscript: Load" & Chr(34) & " tabindex=" & Chr(34) & "-1" & Chr(34) & "></button>"
        End Sub

        ' to read in memory
        Function Read(Path, Var)
            If Var = "*All" Then
                Set FSO = CreateObject("Scripting.FileSystemObject")
                Set File = FSO.OpenTextFile(Path, 1) ' 1 = reading, 2 = write, 8 = write at the end

                allData = File.readall
                File.Close
                For Each ln In Split(allData, vbCrLf)
                    output = output & ln & vbCrLf
                Next

                ' memory management (vbs does not have one for objects only vars have one)
                Set File = Nothing
                Set FSO = Nothing

                ' return
                Read = output
            ElseIf Var = "*AllData" Then
                Set FSO = CreateObject("Scripting.FileSystemObject")
                Set File = FSO.OpenTextFile(Path, 1) ' 1 = reading, 2 = write, 8 = write at the end

                If FSO.GetFile(Path).Size = 0 Then ' if the file is empty
                    Read = ""
                    Exit Function
                End If

                allData = File.readall
                File.Close
                For Each ln In Split(allData, vbCrLf)
                    If ln <> "" Then
                        output = output & Split(ln, " ", 2)(1) & vbCrLf
                    End If
                Next

                ' memory management (vbs does not have one for objects only vars have one)
                Set File = Nothing
                Set FSO = Nothing

                ' return
                Read = output
            Else
                Set FSO = CreateObject("Scripting.FileSystemObject")
                Set File = FSO.OpenTextFile(Path, 1) ' 1 = reading, 2 = write, 8 = write at the end

                allData = File.readall
                File.Close
                For Each ln In Split(allData, vbCrLf)
                    VarName = Split(ln, " ", 2)(0)
                    If VarName = Var Then
                        output = Split(ln, " ", 2)(1)
                        Exit For
                    End If
                Next

                ' memory management (vbs does not have one for objects only vars have one)
                Set File = Nothing
                Set FSO = Nothing

                ' return
                Read = output
            End If
        End Function

        ' to write in memory
        Function Write(Path, Var, Text)
            Set FSO = CreateObject("Scripting.FileSystemObject")
            Set File = FSO.OpenTextFile(Path, 1) ' 1 = reading, 2 = write, 8 = write at the end
            PathOver = Split(Path, "\")
            i = -1
            For each x in PathOver
                i = i+1
            Next

            PathOverwrite = ""
            y = -1

            For each x in PathOver
                y = y+1
                If Not y = i Then
                    PathOverwrite = PathOverwrite & x & "\"
                Else
                    PathOverwrite = PathOverwrite & "temp.dat"
                End If
            Next

            Set FileOver = FSO.CreateTextFile(PathOverwrite, 2) ' 1 = reading, 2 = write, 8 = write at the end

            Do While Not File.AtEndofStream
                ln = File.ReadLine
                VarName = Split(ln, " ", 2)(0)
                If VarName = Var Then
                    FileOver.WriteLine Var & " " & Text
                Else
                    FileOver.WriteLine ln
                End If
            Loop

            File.Close
            FileOver.Close

            Set FileOver = FSO.OpenTextFile(PathOverwrite, 1)
            Set File = FSO.OpenTextFile(Path, 2)

            File.Write ""
            text = FileOver.ReadAll
            File.Write text
            File.Close
            FileOver.Close

            FSO.DeleteFile(PathOverwrite)
        End Function

        Sub Up(FavId)
            focus(Window)
            msgbox FavId
        End Sub

        Sub Down(FavId)
            focus(Window)
            msgbox FavId
        End Sub

        Sub Remove(FavId)
            focus(Window)
            msgbox FavId

            window.returnValue = Split(Read(".\Data\dat\Favorites.dat", "*AllData"), vbCrLf)(FavId-1)
            window.close()
        End Sub

        Sub focus(obj)
            obj.focus()
        End Sub

        Sub Window_OnUnload
            ' window.returnValue = returnArr
            i = 0
            For Each fav in Split(Read(".\Data\dat\Favorites.dat", "*AllData"), vbCrLf)
                Write ".\Data\dat\Favorites.dat", i, fav
                i = i + 1
                If i = max Then
                    Exit For
                End If
            Next
            window.close()
        End Sub
    </script>

    <div id="Favs">
        <!-- <button type="button" id="Fav1UpButton" style="height: 24px; width: 24px;" name="Fav1UpButton" onclick="vbscript: Up 1" tabindex="-1"></button> -->
        <!-- <button type="button" id="Fav1DownButton" style="height: 24px; width: 24px;" name="Fav1DownButton" onclick="vbscript: Down 1" tabindex="-1"></button> -->
        <!-- Fav1 | <span id="Fav1Span"></span> -->
        <!-- <button type="button" id="Fav1RemoveButton" style="height: 24px; width: 24px;" name="Fav1RemoveButton" onclick="vbscript: Remove 1" tabindex="-1"></button> -->
        <!-- <br> -->
    </div>
</body>

</html>