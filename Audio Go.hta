<html lang="en">

<head>
    <title>Audio Go</title>
    <HTA:APPLICATION ID="oHTA" APPLICATIONNAME="Audio Go" ICON="Ico's\AppIcon.ico" BORDER="Dialog" CAPTION="Yes"
        SCROLL="No" SHOWINTASKBAR="Yes" SINGLEINSTANCE="No" SYSMENU="Yes" WINDOWSTATE="normal" MaximizeButton="No">
</head>

<script language="VBScript">
' Resize the window
Window.ResizeTo 392, 167 ' false x, true y

'Create the Audio Player Object
Dim oPlayer: Set oPlayer = CreateObject("WMPlayer.OCX")

' Create the vars
started = false
isPlaying = false
isLooping = false
pressedSpace = false
pressedR = false
startVolume = 50

' Pause States
StatePause = "Png's\PlayIcon.png"
StatePlay = "Png's\PauseIcon.png"

' Loop States
StateNoLoop = "Png's\LoopIcon.png"
StateLoop = "Png's\InfLoopIcon.png"

' is called when a song is chosen
Sub StartUp
    started = true
    ' Play audio
    oPlayer.URL = document.getElementById("mp3Selector").value
    oPlayer.settings.volume = startVolume
    ' ex. oPlayer.Controls.currentPosition = 0 ? test = oPlayer.Controls.currentPosition
    'While oPlayer.playState <> 1 // 1 = Stopped

    ' msgbox oPlayer.currentmedia.duration
End Sub

Sub mp3Selector_OnClick
    started = false
    oPlayer.controls.pause
    isPlaying = false
    isLooping = false

    document.getElementById("PauseImg").src = StatePause
    document.getElementById("LoopImg").src = StateNoLoop
End Sub

' Called each time a key is pressed
Sub document_OnKeyDown
    If Window.event.keyCode = 32 Then TogglePause()
    If Window.event.keyCode = 82 Then If started = true Then ToggleLoop()
    If Window.event.keyCode = 37 Then If started = true Then MinusButton_OnClick()
    If Window.event.keyCode = 39 Then If started = true Then PlusButton_OnClick()
    If Window.event.keyCode = 38 Then If started = true Then VolumeUpButton_OnClick()
    If Window.event.keyCode = 40 Then If started = true Then VolumeDownButton_OnClick()
End Sub

Sub TogglePause
    If isPlaying = false Then If pressedSpace = false Then Play()
    If isPlaying = true Then If pressedSpace = false Then Pause()
    pressedSpace = false
End Sub

Sub PauseButton_OnClick
    If started = true Then TogglePause()
    If started = false Then If(document.getElementById("mp3Selector").value <> "") = true Then TogglePause()
End Sub
    
Sub Play
    If started = false Then StartUp()
    document.getElementById("PauseImg").src = StatePlay
    oPlayer.controls.play
    isPlaying = true
    pressedSpace = true
End Sub

Sub Pause
    document.getElementById("PauseImg").src = StatePause
    oPlayer.controls.pause
    isPlaying = false
    pressedSpace = true
End Sub

Sub MinusButton_OnClick
    oPlayer.controls.currentPosition = oPlayer.controls.currentPosition - 5
End Sub

Sub PlusButton_OnClick
    oPlayer.controls.currentPosition = oPlayer.controls.currentPosition + 5
End Sub

Sub VolumeDownButton_OnClick
    oPlayer.settings.volume = oPlayer.settings.volume - 5
    startVolume = startVolume - 5
End Sub

Sub VolumeUpButton_OnClick
    oPlayer.settings.volume = oPlayer.settings.volume + 5
    startVolume = startVolume + 5
End Sub

Sub LoopButton_OnClick
    If started = true Then ToggleLoop()
End Sub

Sub ToggleLoop
    If isLooping = true Then If pressedR = false Then setLoop(False)
    If isLooping = false Then If pressedR = false Then setLoop(True)
    pressedR = false
End Sub

Sub setLoop(Bool)
    oPlayer.settings.setMode "loop", Bool
    pressedR = true
    If isLooping = true Then document.getElementById("LoopImg").src = StateNoLoop
    If isLooping = false Then document.getElementById("LoopImg").src = StateLoop
    isLooping = Bool
End Sub

Sub Foo
End Sub

</script>

<body>
    <input type="file" id="mp3Selector" name="mp3Selector" value="" onclick="focus(Window)" tabindex="-1">

    <br>

    <button type="button" id="MinusButton" style="margin: 0px;" name="MinusButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's/-TimeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="PauseButton" style="margin: 0px 6px 0px;" name="PauseButton" onclick="focus(Window)" tabindex="-1">
        <img id="PauseImg" src="Png's/PlayIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="PlusButton" style="margin: 0px;" name="PlusButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's\+TimeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="VolumeDownButton" style="margin: 0px 6px 0px;" name="VolumeDownButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's\-VolumeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="VolumeUpButton" style="margin: 0px;" name="VolumeUpButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's\+VolumeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="LoopButton" style="margin: 0px 17px 0px;" name="LoopButton" onclick="focus(Window)" tabindex="-1">
        <img id="LoopImg" src="Png's\LoopIcon.png" height="32px" width="32px" /></button>
</body>
