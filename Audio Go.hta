<html lang="en">

<head>
    <title>Audio Go</title>
    <HTA:APPLICATION ID="oHTA" APPLICATIONNAME="Audio Go" ICON="Ico's\AppIcon.ico" BORDER="Dialog" CAPTION="Yes"
        SCROLL="No" SHOWINTASKBAR="Yes" SINGLEINSTANCE="No" SYSMENU="Yes" WINDOWSTATE="normal" MaximizeButton="No">
</head>

<script language="VBScript">
' Resize the window
Window.ResizeTo 392, 190 ' false x, true y

'Create the Audio Player Object
Dim oPlayer: Set oPlayer = CreateObject("WMPlayer.OCX")

' Create the vars
started = false
isPlaying = false
isLooping = false
pressedSpace = false
pressedR = false
startVolume = 50

' Bindings
ChangingKey = 0

Key_close = 27
    Key_close_show = "escape"
Key_pause = 32
    Key_pause_show = "space"
Key_loop = 82
    Key_loop_show = "r"
Key_minus = 37
    Key_minus_show = "arrow_left"
Key_plus = 39
    Key_plus_show = "arrow_right"
Key_up = 38
    Key_up_show = "arrow_up"
Key_down = 40
    Key_down_show = "arrow_down"

' Pause States
StatePause = "Png's\PlayIcon.png"
StatePlay = "Png's\PauseIcon.png"

' Loop States
StateNoLoop = "Png's\NoLoopIcon.png"
StateLoop = "Png's\LoopIcon.png"

' Volume States
StateMinusVolume = "Png's\-VolumeIcon.png"
StateMinVolume = "Png's\-MinVolumeIcon.png"

StatePlusVolume = "Png's\+VolumeIcon.png"
StateMaxVolume = "Png's\+MaxVolumeIcon.png"

' is called when a song is chosen
Sub StartUp
    started = true
    ' Play audio
    oPlayer.URL = document.getElementById("mp3Selector").value
    oPlayer.settings.volume = startVolume
    ' ex. oPlayer.Controls.currentPosition = 0 ? test = oPlayer.Controls.currentPosition
    'While oPlayer.playState <> 1 // 1 = Stopped

    ' msgbox oPlayer.currentmedia.duration
End Sub

Sub mp3Selector_OnClick
    started = false
    oPlayer.controls.pause
    isPlaying = false
    isLooping = false

    document.getElementById("PauseImg").src = StatePause
    document.getElementById("LoopImg").src = StateNoLoop
End Sub

' Called each time a key is pressed
Sub document_OnKeyDown
    If Not ChangingKey = 0 Then
        Select Case ChangingKey
            Case 1
                Key_close = rebind(Window.event.keyCode)
            Case 2
                Key_pause = rebind(Window.event.keyCode)
            Case 3
                Key_loop = rebind(Window.event.keyCode)
            Case 4
                Key_minus = rebind(Window.event.keyCode)
            Case 5
                Key_plus = rebind(Window.event.keyCode)
            Case 6
                Key_up = rebind(Window.event.keyCode)
            Case 7
                Key_down = rebind(Window.event.keyCode)
            Case Else
                msgbox "Error var: ChangingKey is not in range"
        End Select
    Else
        If Window.event.keyCode = Key_close Then Window.close()
        If Window.event.keyCode = Key_pause Then TogglePause()
        If Window.event.keyCode = Key_loop Then If started = true Then ToggleLoop()
        If Window.event.keyCode = Key_minus Then If started = true Then MinusButton_OnClick()
        If Window.event.keyCode = Key_plus Then If started = true Then PlusButton_OnClick()
        If Window.event.keyCode = Key_up Then If started = true Then VolumeUpButton_OnClick()
        If Window.event.keyCode = Key_down Then If started = true Then VolumeDownButton_OnClick()
    End If
End Sub

Function rebind(keyCode)

    ChangingKey = 0
    rebind = keyCode
End Function

Sub TogglePause
    If isPlaying = false Then If pressedSpace = false Then Play()
    If isPlaying = true Then If pressedSpace = false Then Pause()
    pressedSpace = false
End Sub

Sub PauseButton_OnClick
    If started = true Then TogglePause()
    If started = false Then If(document.getElementById("mp3Selector").value <> "") = true Then TogglePause()
End Sub
    
Sub Play
    If started = false Then StartUp()
    document.getElementById("PauseImg").src = StatePlay
    oPlayer.controls.play
    isPlaying = true
    pressedSpace = true
End Sub

Sub Pause
    document.getElementById("PauseImg").src = StatePause
    oPlayer.controls.pause
    isPlaying = false
    pressedSpace = true
End Sub

Sub RebindButton_OnClick
    msgbox Window.showModalDialog("Hta's\Rebind.hta", "", "dialogHeight: 200px; dialogWidth: 300px;")
    ChangingKey = 1
End Sub

Sub MinusButton_OnClick
    oPlayer.controls.currentPosition = oPlayer.controls.currentPosition - 5
End Sub

Sub PlusButton_OnClick
    oPlayer.controls.currentPosition = oPlayer.controls.currentPosition + 5
End Sub

Sub VolumeDownButton_OnClick
    If oPlayer.settings.volume < 6 Then
        document.getElementById("DownImg").src = StateMinVolume
    Else 
        document.getElementById("UpImg").src = StatePlusVolume
    End If

    oPlayer.settings.volume = oPlayer.settings.volume - 5
    startVolume = startVolume - 5
End Sub

Sub VolumeUpButton_OnClick
    If oPlayer.settings.volume > 94 Then
        document.getElementById("UpImg").src = StateMaxVolume
    Else 
        document.getElementById("DownImg").src = StateMinusVolume
    End If

    oPlayer.settings.volume = oPlayer.settings.volume + 5
    startVolume = startVolume + 5
End Sub

Sub LoopButton_OnClick
    If started = true Then ToggleLoop()
End Sub

Sub ToggleLoop
    If isLooping = true Then If pressedR = false Then setLoop(False)
    If isLooping = false Then If pressedR = false Then setLoop(True)
    pressedR = false
End Sub

Sub setLoop(Bool)
    oPlayer.settings.setMode "loop", Bool
    pressedR = true
    If isLooping = true Then document.getElementById("LoopImg").src = StateNoLoop
    If isLooping = false Then document.getElementById("LoopImg").src = StateLoop
    isLooping = Bool
End Sub

Sub Foo
End Sub

</script>

<body>
    <!-- First Layer -->
    <button type="button" id="RebindButton" style="height: 16px; width: 16px;" name="RebindButton" onclick="focus(Window)" tabindex="-1"></button>

    <br>

    <!-- Second Layer -->
    <input type="file" id="mp3Selector" name="mp3Selector" value="" onclick="focus(Window)" tabindex="-1">

    <br>

    <!-- Third Layer -->
    <button type="button" id="MinusButton" style="margin: 0px;" name="MinusButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's/-TimeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="PauseButton" style="margin: 0px 6px 0px;" name="PauseButton" onclick="focus(Window)" tabindex="-1">
        <img id="PauseImg" src="Png's/PlayIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="PlusButton" style="margin: 0px;" name="PlusButton" onclick="focus(Window)" tabindex="-1">
        <img src="Png's\+TimeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="VolumeDownButton" style="margin: 0px 6px 0px;" name="VolumeDownButton" onclick="focus(Window)" tabindex="-1">
        <img id="DownImg" src="Png's\-VolumeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="VolumeUpButton" style="margin: 0px;" name="VolumeUpButton" onclick="focus(Window)" tabindex="-1">
        <img id="UpImg" src="Png's\+VolumeIcon.png" height="32px" width="32px" /></button>
    <button type="button" id="LoopButton" style="margin: 0px 17px 0px;" name="LoopButton" onclick="focus(Window)" tabindex="-1">
        <img id="LoopImg" src="Png's\NoLoopIcon.png" height="32px" width="32px" /></button>
</body>
